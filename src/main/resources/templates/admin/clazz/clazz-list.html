<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title></title>
  <script src="/lib/layui2.7.6/layui.js" charset="utf-8"></script>
  <script type="module" src="/lib/xy-ui/index.js">
  </script>
</head>
<body>
<div v-scope>
  <div style="margin: 20px;">
    <xy-input placeholder="请输入搜索的内容"></xy-input>
    <xy-button type="primary">搜索</xy-button>
    <xy-button onclick="openScoreAdd()">添加用户</xy-button>
    <xy-button>批量删除</xy-button>
    <xy-button>批量导入</xy-button>
  </div>
  <xy-table thead="选择,班级ID,班级,专业,辅导员,操作"
            @vue:mounted="getScoreList()">
    <xy-tr v-for="(item,index) in scoreListData" :key="index">
      <xy-td>
        <xy-checkbox></xy-checkbox>
      </xy-td>
      <xy-td>{{item.clazzId}}</xy-td>
      <xy-td>{{item.clazzName}}</xy-td>
      <xy-td>{{item.majorName}}</xy-td>
      <xy-td>{{item.teacherName}}</xy-td>
      <xy-td>
        <xy-button @click="openScoreEdit(item)">编辑</xy-button>
        <xy-button type="danger">删除</xy-button>
      </xy-td>
    </xy-tr>
  </xy-table>
  <div style="display: flex;justify-content: center;margin-top: 20px">
    <xy-pagination pagesize="3" total="50"></xy-pagination>
  </div>
</div>
<script src="/lib/petite-vue.iife.js"></script>
<script>
  function openScoreEdit(item) {
    console.log(item)
    layer.open({
      type: 2,
      title: '编辑成绩信息',
      shadeClose: true,
      shade: 0.3,
      maxmin: true, //开启最大化最小化按钮
      area: ['600px', '400px'],
      content: `/score_edit?scoreId=${item.scoreId}&scoreNum=${item.scoreNum}`
    });
  }

  function openScoreAdd() {
    layer.open({
      type: 2,
      title: '添加学生',
      shadeClose: true,
      shade: 0.3,
      maxmin: true, //开启最大化最小化按钮
      area: ['600px', '400px'],
      content: '/score_add'
    });
  }

  const scoreListData = PetiteVue.reactive([])
  PetiteVue.createApp({
    scoreListData
  }).mount()

  function getScoreList() {
    fetch("/clazz/list")
            .then(res => {
              return res.json()
            })
            .then(data => {
              scoreListData.push(...data.data)
            })
  }

</script>
</body>
</html>